---
title: 'DEL HOGAR AL AULA: FACTORES QUE EXPLICAN EL RENDIMIENTO EN MATEMTICAS'
author: "WILLIAM DAVID IBICA PREGONERO"
date: "2025-06-21"
output:
  html_document:
    df_print: paged
---

```{r,echo=FALSE, include=FALSE}
library(dplyr)
library(readxl)
library(ggplot2)
library(GGally)
library(RcmdrMisc)
library(car)
library(tidyverse)
library(modelr)
library(devtools)
library(conflicted)
library(MASS)
library(effects)
library(nortest)
library(DescTools)
library(lmtest)
library(MASS)
library(sjPlot)
library(olsrr)

homoceda <- readRDS(file = "homoceda.rds")
Hist_residuales <- readRDS(file = "Hist_residuales.rds")
Q_Q <- readRDS(file = "Q_Q.rds")
lineal <- readRDS(file = "lineal.rds")

```

## Introducci贸n

En el 谩mbito educativo, la evaluaci贸n del rendimiento acad茅mico de los estudiantes ha sido objeto de numerosos estudios a nivel nacional e internacional, especialmente en las 谩reas de ciencias naturales, matem谩ticas y lenguaje. Diversas investigaciones el g茅nero del estudiante pueden influir significativamente en los resultados obtenidos por los alumnos en pruebas estandarizadas.

El presente an谩lisis se enmarca en este contexto y utiliza como fuente la base de datos del Instituto Colombiano para la Evaluaci贸n de la Educaci贸n (ICFES) correspondiente al segundo semestre del a帽o 2024 2. La muestra analizada se restringe al departamento de Casanare, lo cual permite enfocar el estudio en una regi贸n espec铆fica del pa铆s y observar sus caracter铆sticas particulares.

## Objetivo general

Analizar el efecto del nivel educativo de la madre y del nivel socioecon贸mico del estudiante sobre el puntaje en matem谩ticas , controlando la influencia del puntaje en lectura cr铆tica como covariable.

-   Estimar el efecto del nivel educativo de la madre y del nivel socioecon贸mico sobre el rendimiento en matem谩ticas, ajustando por el puntaje en lectura cr铆tica.

-   Evaluar si el puntaje en lectura cr铆tica se asocia significativamente con el puntaje en matem谩ticas, cuando se controlan los efectos del nivel educativo de la madre y el nivel socioecon贸mico.

-   Determinar si existen diferencias significativas en el puntaje en matem谩ticas entre los distintos niveles educativos de la madre y niveles socioecon贸micos, ajustando por la covariable.

## Datos

La base de datos utilizada en este estudio proviene del ICFES y corresponde a los resultados de las pruebas estandarizadas aplicadas en el periodo $2024-2$. La muestra se limita a un total de 5465 estudiantes del departamento de Casanare (Colombia), y contiene informaci贸n relevante para el an谩lisis del rendimiento acad茅mico en matem谩ticas, as铆 como variables asociadas a caracter铆sticas individuales y del entorno familiar del estudiante.

```{r, fig.pos="h", out.width="70%", fig.cap="Tabla de variables", echo=FALSE}
knitr::include_graphics("Tabla_variables.PNG")
```

El procedimiento estad铆stico utilizado para analizar el efecto de dos factores categ贸ricos y una covariable continua sobre el desempe帽o acad茅mico en matem谩ticas de estudiantes de educaci贸n media. Para tal fin, se implement贸 un modelo de an谩lisis de covarianza, que permite comparar las medias ajustadas del puntaje en matem谩ticas entre grupos definidos por el nivel educativo de la madre y el nivel socioecon贸mico del estudiante, controlando el efecto del puntaje en lectura cr铆tica como covariable.

Este dise帽o permite evaluar si existen diferencias significativas en el rendimiento en matem谩ticas atribuibles a las condiciones socioculturales y econ贸micas del entorno familiar, una vez que se ha ajustado estad铆sticamente el efecto del desempe帽o en lectura cr铆tica.

## M茅todos

La formulaci贸n general del modelo se expresa de la siguiente manera:

$$Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \gamma X_k + \epsilon_{ijk}$$

Explicaci贸n de T茅rminos

| S铆mbolo | Descripci贸n |
|------------------------------------|------------------------------------|
| $Y_{ijk}$ | Variable respuesta (ej: puntaje en matem谩ticas). |
| $\mu$ | Media global del modelo. |
| $\alpha_i$ | Efecto del $i$-茅simo nivel del **primer factor categ贸rico** (ej: Grupo). |
| $\beta_j$ | Efecto del $j$-茅simo nivel del **segundo factor categ贸rico** (ej: Tratamiento). |
| $(\alpha\beta)_{ij}$ | Interacci贸n entre los dos factores. |
| $\gamma X_k$ | Efecto de la **covariable continua** $X_k$ (ej: Edad). |
| $\epsilon_{ijk}$ | Error aleatorio $\sim N(0, \sigma^2)$. |

*Supuestos del Modelo ANCOVA*

Para que las inferencias del modelo sean v谩lidas y robustas , deben cumplirse los siguientes supuestos estad铆sticos:

-   Independencia de las observaciones: los estudiantes son unidades estad铆sticas independientes.

-   Relaci贸n lineal entre la covariable y la variable dependiente: se asume que existe una relaci贸n lineal entre el puntaje en lectura cr铆tica y el puntaje en matem谩ticas.

-   Homogeneidad de pendientes: la relaci贸n entre la covariable y la variable respuesta es constante en todos los niveles de los factores.

-   Homocedasticidad: se espera varianza constante de los errores en los distintos grupos.

-   Normalidad de los errores residuales: los residuos del modelo deben seguir una distribuci贸n normal.

# An谩lisis Diagn贸stico del Modelo

Ante la diversidad de variables disponibles como posibles predictores, se implement贸 un a estrategia metodol贸gica para identificar el conjunto 贸ptimo de variables. Este enfoque buscar谩 equilibrar la capacidad predictiva del modelo m谩s simple y con el menor n煤mero de supuestos (principio de parsimonia), garantizando as铆 un modelo robusto e interpretable.

Una vez ajustado el modelo se procede a realizar un conjunto de an谩lisis diagn贸sticos con el fin de evaluar su validez estad铆stica y asegurar la fiabilidad de las inferencias. \# Software - SAS (versi贸n 9.4): utilizado para el preprocesamiento de datos, recodificaci贸n de variables, an谩lisis descriptivo y ejecuci贸n del modelo ANCOVA.

-   RStudio (versi贸n 2024.03.0): se emple贸 de forma complementaria para la verificaci贸n cruzada de resultados mediante el uso de los paquetes car (Anova Type III), ggplot2 (visualizaci贸n de efectos marginales) y emmeans (estimaci贸n de medi as marginales ajustadas).

## Resultados y discusi贸n

Los resultados finales desde los distintos m茅todos exploratorios realizados para la obtenci贸n del modelo m谩s simple fueron Modelo ANCOVA a dos v铆as:

**Componentes aleatorios**

$$ Y_{ijk} \sim Normal(\mu_{ijk}, \sigma^2) $$

$$ \epsilon_{ijk} \sim Normal(\mu_{ijk}, \sigma^2) $$

$$ Var(\epsilon_{ij}) = \sigma^2, \ \forall_{i,j} $$

**Descripci贸n del modelo**

-   Variables finales:

1.  Variable respuesta: Puntaje en matem谩ticas

2.  Variables Explicativas: estas est谩n en dos categor铆as Factores (Nivel educativo de la madre nivel socioecon贸mico del estudiante)

3.  Covariable: Puntaje en lectura cr铆tica

```{r, fig.pos="h", out.width="70%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Caracter铆sticas.PNG")
```

EL modelo explica el $53.63\%$ de la variabilidad de los datos, esto sugiere un buen porcentaje y se puede observar en el coeficiente de determinaci贸n m煤ltiple $^2(d)$, adem谩s, 茅l $ = 909.86$ es significativo. Esto confirma que, en conjunto, las variables independientes utilizadas explican una proporci贸n significativa de la variabilidad observada. Adicional mente, la ra铆z del error cuadr谩tico medio (Ra铆z MSE) fue 8.54, l o que sugiere una dispersi贸n moderada de los residuos alrededor de las predicciones del modelo.

```{r, fig.pos="h", out.width="50%", fig.cap="Modelo", echo=FALSE}
knitr::include_graphics("Modelo.PNG")
```

El an谩lisis de los coeficientes estimados del modelo general lineal revela efectos significativos de las variables explicativas sobre el puntaje en matem谩tica s, controlando por el nivel socioecon贸mico individual y el puntaje en lectura cr铆tica. En relaci贸n con el nivel educativo de la madre (educ_madre_ord), se observ贸 que los estudiantes cuyas madres poseen un nivel educativo bajo presentan, en promedio, una disminuci贸n de 1.65 puntos en el puntaje de matem谩ticas en comparaci贸n con aquellos cuya madre tiene un nivel educativo alto, diferencia que result贸 altamente significativa **(p \< 0.0001)**. Asimismo, los estudiantes del nivel intermedio evidencian una disminuci贸n promedio de 0.71 puntos respecto al nivel alto, tambi茅n estad铆sticamente significativa **(p = 0.0359)**.

Respecto al nivel socioecon贸mico individual, 煤nicamente la categor铆a m谩s baja mostr贸 una diferencia significativa. Los estudiantes clasificados en el nivel socioecon贸mico obtuvieron en promedio 1.46 puntos menos que aquellos pertenecientes al nivel alto (categor铆a de referencia), con un valor p de 0.0223. Las dem谩s categor铆as socioecon贸micas no mostraron efectos estad铆sticamente significativos en comparaci贸n con el nivel alto. Por su parte, la covariable punt_lectura_critica present贸 un coeficiente positivo altamente significativo (尾 = 0.8826; Por su parte, la covariable punt_lectura_critica present贸 un coeficiente positivo altamente significativo (尾 = 0.8826; p \< 0.0001), lo cual indica que, manteniendo constantes los dem谩s factores, un incremento dep \< 0.0001), lo cual indica que, manteniendo constantes los dem谩s factores, un incremento de un punto en el puntaje un punto en el puntaje de lectura cr铆tica se asocia con un aumento promedio de 0.88 puntos en el puntaje de matem谩ticas. Este hallazgo de lectura cr铆tica se asocia con un aumento promedio de 0.88 puntos en el puntaje de matem谩ticas. Este hallazgo resalta la influencia directa del rendimiento en lectura cr铆tica sobre el desempe帽o en matem谩ticas, reforzando su resalta la influencia directa del rendimiento en lectura cr铆tica sobre el desempe帽o en matem谩ticas, reforzando su inclusi贸n como covariable relevante en el modelo.

**Estad铆sticos descriptivos**

```{r, fig.pos="h", out.width="70%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("descriptivas.PNG")
```

Los resultados descriptivos muestran que tanto el nivel educativo de la madre como el nivel socioecon贸mico individual del estudiante est谩n relacionados positivamente con el desempe帽o en lectura cr铆tica. En promedio, los estudiantes cuya madre tiene mayor nivel educativo obtienen mejores puntajes, pasando de 51.76 a 57.37 puntos. De forma similar, a mayor nivel socioecon贸mico, los puntajes tambi茅n aumentan, desde 50.55 en el nivel bajo hasta 61.50 en el nivel alto. Estos resultados sugieren que ambos factores est谩n asociados con un mejor rendimiento en lectura cr铆tica.

## Verificaci贸n de supuestos

-   **Independencia**

Se valido mediante la prueba de Durbin Watson, ya que como es una muestra grande, las otras pruebas podr铆an, afectar la decisi贸n en el juzgamiento

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Independencia.PNG")
```

Podemos observar que el p valor es mayor que cualquier nivel de significancia, no se rechaza la hip贸tesis nula de ausencia de autocorrelaci贸n. Por tanto, no hay evidencia estad铆sticamente significativa de autocorrelaci贸n en los residuos del modelo, lo cual indica que se cumple el supuesto de independencia de los errores en la regresi贸n.

-   **Relaci贸n lineal**

```{r, fig.pos="h", out.width="60%", fig.cap="Medidas descriptivas", echo=FALSE, warning=FALSE, message=FALSE}
lineal
```

El gr谩fico sugiere que la relaci贸n entre la covariable (puntaje en lectura cr铆tica) y la variable puntaje en matem谩ticas es aproximadamente lineal dentro de cada nivel del factor socioecon贸mico. Por tanto, el supuesto de linealidad para el modelo ANCOVA se considera razonablemente cumplido.

-   **Homogeneidad**

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("homogeneidad.PNG")
```

La prueba de homogeneidad de pendientes no fue significativa por el p valor obtenido , lo que indica que la relaci贸n entre el covariable puntaje lectura cr铆tica y la variable dependiente punt aje en matem谩ticas es constante entre los niveles socioecon贸micos del estudiante. Por tanto, se cumple el supuesto de homogeneidad de pendientes en el modelo ANCOVA.

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Homo_pendientes.PNG")
```

-   **Homocedasticidad** Se valido mediante gr谩fico de residuos vs valores ajustados y la prueba de Breusch Pagan

```{r, fig.pos="h", out.width="45%", fig.cap="homocedasticidad", echo=FALSE, include=FALSE, message=FALSE}
homoceda
```

El gr谩fico de escala localizaci贸n sugiere que los residuos presentan una varianza aproximadamente constante a lo largo de los valores ajustados , esto podr铆a afirmar que el supuesto de homocedasticidad se considera cumplido.

```{r, fig.pos="h", out.width="45%", echo=FALSE}
knitr::include_graphics("Homocedasticidad.PNG")
```

Como el p valor es mayor que cualquier nivel de significancia, no se rechaza la hip贸tesis nula de homocedasticidad. En consecuencia, se puede asumir que se cumple el supuesto de varianza constante de los errores

-   **Normalidad de residuos**

Se examina visualmente a trav茅s del gr谩fico Cuantil-Cuantil (Q-Q plot) y se contrasta estad铆sticamente mediante la prueba de Kolmog贸rov Smirnov , dado que la muestra es considerablemente grande , tambi茅n se realizo un histograma p ara dar una breve observaci贸n

*Histograma*

```{r,  fig.pos="h", out.width="45%", fig.cap="cuantil_cuantil", warning=FALSE, message=FALSE}
Q_Q
```

**Histograma**

```{r,  fig.pos="h", out.width="45%", fig.cap="Histograma", warning=FALSE, message=FALSE}
Hist_residuales
```

Se observa en el gr谩fico Q_Q que los residuos est谩n alineados mayoritariamente a la l铆nea referencial te贸rica , esto indagar铆a que no hay desviaciones significativas respecto a la normalidad de los residuos. Si bien se aprecia una leve discrepancia en los extremos del gr谩fico, este comportamiento es com煤n en datos reales y no constituye una irregularidad que comprometa la validez del modelo

```{r, fig.pos="h", out.width="45%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Normalidad.PNG")
```

Con esta prueba, aunque no tan confiable por el n煤mero de datos , se observa que el p valor no es significativo, luego no se rechaza la hip贸tesis nula, entonces, los residuos siguen una distribuci贸n Normal.

## Detenci贸n de datos influyentes

```{r, fig.pos="h", out.width="150%", echo=FALSE}
knitr::include_graphics("DFFIT.PNG")
```

Los gr谩ficos de diagn贸stico revelan que, en general, el modelo de regresi贸n no presenta problemas graves de influencia o valores at铆picos. El gr谩fico de DFFITS muestra que la mayor铆a de las observaciones no tienen un impacto significativo en las predicci贸n es. Sin embargo, en el gr谩fico de Cooks Distance se identifica una observaci贸n alrededor del 铆ndice 3000 con una influencia destacada. Los gr谩ficos de leverage y residuos estandarizados confirman que, aunque la mayor铆a de los puntos son normales, existen algunas observaciones espec铆ficas (como las cercanas a los 铆ndices 2900 y 4472) que combinan alto leverage y residuos grandes, indicando que podr铆an estar afectando el ajuste del modelo. Se recomienda revisar a futuro estas observaciones influyentes para a segurar la robustez del modelo.

## Eliminaci贸n

Para asegurar la validez del modelo ANCOVA y mejorar la precisi贸n de las estimaciones, se realiz贸 una depuraci贸n del conjunto de datos mediante la identificaci贸n y eliminaci贸n de observaciones at铆picas multivariantes.

La detecci贸n se bas贸 en el c谩lculo de la distancia de Mahalanobis aplicada a las variables num茅ricas involucradas en el modelo: punt_matematicas y punt_lectura_critica. Se estableci贸 como umbral de corte el percentil 99 de la distribuci贸n Chi-cuadrado con 2 grados de libertad, eliminando aquellas observaciones que superaban dicho l铆mite.

Como resultado, se obtuvo un conjunto de datos m谩s robusto, libre de valores extremos que pudieran influir de forma indebida en la interpretaci贸n de los efectos de los factores educ_madre_ord y estu_nse_individual sobre el rendimiento en matem谩ticas, controlando por el puntaje en lectura cr铆tica.

```{r, fig.pos="h", out.width="60%", echo=FALSE}
knitr::include_graphics("modelo_fin.PNG")
```

El presente estudio implement贸 un modelo de ANCOVA de dos v铆as para analizar los determinantes del rendimiento en matem谩ticas en estudiantes, considerando como variables predictoras: (1) el nivel educativo de la madre (variable ordinal con tres categor铆as), (2) el nivel socioecon贸mico del estudiante (variable ordinal con cuatro categor铆as), y (3) el puntaje en lectura cr铆tica como covariable continua. Antes del ajuste del modelo, se eliminaron observaciones at铆picas multivariantes mediante el c谩lculo de la distancia de Mahalanobis sobre las variables num茅ricas implicadas, con el fin de mejorar la robustez del an谩lisis y reducir la influencia de valores extremos.

El modelo final, libre de datos at铆picos, fue validado mediante el cumplimiento de los supuestos estad铆sticos (normalidad de residuos, homocedasticidad y linealidad), mostrando un buen ajuste para el an谩lisis inferencial.

Los resultados revelaron patrones consistentes con la literatura educativa. La covariable lectura cr铆tica mostr贸 el efecto m谩s fuerte y estad铆sticamente significativo, con un coeficiente de 0.877 ( \< 0.0001), indicando que, por cada punto adicional en dicha prueba, se espera un aumento promedio de 0.877 puntos en el rendimiento matem谩tico, manteniendo constantes los dem谩s factores. Este resultado reafirma la conexi贸n entre habilidades ling眉铆sticas y desempe帽o en matem谩ticas.

Respecto al nivel educativo de la madre, los estudiantes cuyas madres ten铆an educaci贸n b谩sica incompleta (nivel 1) obtuvieron, en promedio, 1.21 puntos menos que aquellos con madres de educaci贸n superior (nivel de referencia), siendo esta diferencia estad铆sticamente significativa ( = 0.0005). La diferencia para educaci贸n b谩sica completa (nivel 2) fue menor y no significativa (-0.44 puntos;  = 0.1609). Este patr贸n sugiere que el capital educativo del hogar sigue siendo un determinante relevante del rendimiento, especialmente cuando se trata de niveles muy bajos de escolarizaci贸n.

En cuanto al nivel socioecon贸mico individual, el grupo estrato bajo (nivel 1) present贸 una diferencia negativa significativa de 1.48 puntos respecto al estrato alto ( = 0.0123), mientras que los niveles 2 y 3 no mostraron diferencias estad铆sticamente significativas. Esto sugiere que el mayor impacto negativo se concentra en los estudiantes en condiciones de vulnerabilidad extrema, mientras que las diferencias entre niveles medios y altos tienden a diluirse.

## Conclusiones

La competencia en lectura cr铆tica contin煤a siendo el predictor m谩s fuerte del rendimiento en matem谩ticas, lo que respalda enfoques pedag贸gicos integrados que fortalezcan simult谩neamente las habilidades verbales y l贸gico-matem谩ticas.

-   El efecto del nivel educativo de la madre, aunque atenuado tras eliminar los valores extremos, se mantiene como un factor de peso, especialmente en los niveles m谩s bajos. Esto refuerza la necesidad de pol铆ticas educativas intergeneracionales que favorezcan el acceso a la educaci贸n para madres con baja escolaridad.

-   La desventaja significativa observada en el estrato socioecon贸mico bajo pone en evidencia la persistencia de las inequidades estructurales. Este hallazgo justifica la implementaci贸n de estrategias de acompa帽amiento educativo y recursos dirigidos a los estudiantes en mayor riesgo de exclusi贸n.

El modelo ajustado sin at铆picos ofrece una visi贸n m谩s precisa del fen贸meno y mejora la confiabilidad de las inferencias. Se sugiere ampliar el modelo en futuros estudios incorporando variables contextuales adicionales (como calidad docente, infraestructura escolar o apoyo familiar), as铆 como aplicar modelos longitudinales que permitan evaluar c贸mo evolucionan estos efectos a lo largo del tiempo educativo.

## REFERENCIAS

-   <https://www.icfes.gov.co/wp> content/uploads/2024/11/Edicion 4 boletin saber al detalle -

-   -.pdf <https://bookdown.org/j_morales/librostat/ancova.html> Instituto Colombiano para la Evaluaci贸n de la Educaci贸n Icfes. (marzo de 2024). DataIcfes: Repositorio de Datos Abiertos del Icfes. 04.Saber11 [Conjunto de datos]. Recuperado de <https://bitly.ws/3f3YC>

-   <https://statistics.laerd.com/spss> tutorials/two way ancova using spss statistics .php
sadsadasdasdasdas
-   <https://bookdown.org/j_morales/weblinmod/04ML> ANOVA ANCOVA.html
