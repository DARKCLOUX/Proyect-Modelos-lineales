---
title: 'DEL HOGAR AL AULA: FACTORES QUE EXPLICAN EL RENDIMIENTO EN MATEM√ÅTICAS'
author: "WILLIAM DAVID IBICA PREGONERO"
date: "2025-06-21"
output:
  html_document:
    df_print: paged
---

```{r,echo=FALSE, include=FALSE}
library(dplyr)
library(readxl)
library(ggplot2)
library(GGally)
library(RcmdrMisc)
library(car)
library(tidyverse)
library(modelr)
library(devtools)
library(conflicted)
library(MASS)
library(effects)
library(nortest)
library(DescTools)
library(lmtest)
library(MASS)
library(sjPlot)
library(olsrr)

homoceda <- readRDS(file = "homoceda.rds")
Hist_residuales <- readRDS(file = "Hist_residuales.rds")
Q_Q <- readRDS(file = "Q_Q.rds")
lineal <- readRDS(file = "lineal.rds")

```

## Introducci√≥n

En el √°mbito educativo, la evaluaci√≥n del rendimiento acad√©mico de los estudiantes ha sido objeto de numerosos estudios a nivel nacional e internacional, especialmente en las √°reas de ciencias naturales, matem√°ticas y lenguaje. Diversas investigaciones el g√©nero del estudiante pueden influir significativamente en los resultados obtenidos por los alumnos en pruebas estandarizadas.

El presente an√°lisis se enmarca en este contexto y utiliza como fuente la base de datos del Instituto Colombiano para la Evaluaci√≥n de la Educaci√≥n (ICFES) correspondiente al segundo semestre del a√±o 2024 2. La muestra analizada se restringe al departamento de Casanare, lo cual permite enfocar el estudio en una regi√≥n espec√≠fica del pa√≠s y observar sus caracter√≠sticas particulares.

## Objetivo general

Analizar el efecto del nivel educativo de la madre y del nivel socioecon√≥mico del estudiante sobre el puntaje en matem√°ticas , controlando la influencia del puntaje en lectura cr√≠tica como covariable.

-   Estimar el efecto del nivel educativo de la madre y del nivel socioecon√≥mico sobre el rendimiento en matem√°ticas, ajustando por el puntaje en lectura cr√≠tica.

-   Evaluar si el puntaje en lectura cr√≠tica se asocia significativamente con el puntaje en matem√°ticas, cuando se controlan los efectos del nivel educativo de la madre y el nivel socioecon√≥mico.

-   Determinar si existen diferencias significativas en el puntaje en matem√°ticas entre los distintos niveles educativos de la madre y niveles socioecon√≥micos, ajustando por la covariable.

## Datos

La base de datos utilizada en este estudio proviene del ICFES y corresponde a los resultados de las pruebas estandarizadas aplicadas en el periodo $2024-2$. La muestra se limita a un total de 5465 estudiantes del departamento de Casanare (Colombia), y contiene informaci√≥n relevante para el an√°lisis del rendimiento acad√©mico en matem√°ticas, as√≠ como variables asociadas a caracter√≠sticas individuales y del entorno familiar del estudiante.

```{r, fig.pos="h", out.width="70%", fig.cap="Tabla de variables", echo=FALSE}
knitr::include_graphics("Tabla_variables.PNG")
```

El procedimiento estad√≠stico utilizado para analizar el efecto de dos factores categ√≥ricos y una covariable continua sobre el desempe√±o acad√©mico en matem√°ticas de estudiantes de educaci√≥n media. Para tal fin, se implement√≥ un modelo de an√°lisis de covarianza, que permite comparar las medias ajustadas del puntaje en matem√°ticas entre grupos definidos por el nivel educativo de la madre y el nivel socioecon√≥mico del estudiante, controlando el efecto del puntaje en lectura cr√≠tica como covariable.

Este dise√±o permite evaluar si existen diferencias significativas en el rendimiento en matem√°ticas atribuibles a las condiciones socioculturales y econ√≥micas del entorno familiar, una vez que se ha ajustado estad√≠sticamente el efecto del desempe√±o en lectura cr√≠tica.

## M√©todos

La formulaci√≥n general del modelo se expresa de la siguiente manera:

$$Y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha\beta)_{ij} + \gamma X_k + \epsilon_{ijk}$$

Explicaci√≥n de T√©rminos

| S√≠mbolo | Descripci√≥n |
|------------------------------------|------------------------------------|
| $Y_{ijk}$ | Variable respuesta (ej: puntaje en matem√°ticas). |
| $\mu$ | Media global del modelo. |
| $\alpha_i$ | Efecto del $i$-√©simo nivel del **primer factor categ√≥rico** (ej: Grupo). |
| $\beta_j$ | Efecto del $j$-√©simo nivel del **segundo factor categ√≥rico** (ej: Tratamiento). |
| $(\alpha\beta)_{ij}$ | Interacci√≥n entre los dos factores. |
| $\gamma X_k$ | Efecto de la **covariable continua** $X_k$ (ej: Edad). |
| $\epsilon_{ijk}$ | Error aleatorio $\sim N(0, \sigma^2)$. |

*Supuestos del Modelo ANCOVA*

Para que las inferencias del modelo sean v√°lidas y robustas , deben cumplirse los siguientes supuestos estad√≠sticos:

-   Independencia de las observaciones: los estudiantes son unidades estad√≠sticas independientes.

-   Relaci√≥n lineal entre la covariable y la variable dependiente: se asume que existe una relaci√≥n lineal entre el puntaje en lectura cr√≠tica y el puntaje en matem√°ticas.

-   Homogeneidad de pendientes: la relaci√≥n entre la covariable y la variable respuesta es constante en todos los niveles de los factores.

-   Homocedasticidad: se espera varianza constante de los errores en los distintos grupos.

-   Normalidad de los errores residuales: los residuos del modelo deben seguir una distribuci√≥n normal.

# An√°lisis Diagn√≥stico del Modelo

Ante la diversidad de variables disponibles como posibles predictores, se implement√≥ un a estrategia metodol√≥gica para identificar el conjunto √≥ptimo de variables. Este enfoque buscar√° equilibrar la capacidad predictiva del modelo m√°s simple y con el menor n√∫mero de supuestos (principio de parsimonia), garantizando as√≠ un modelo robusto e interpretable.

Una vez ajustado el modelo se procede a realizar un conjunto de an√°lisis diagn√≥sticos con el fin de evaluar su validez estad√≠stica y asegurar la fiabilidad de las inferencias. \# Software - SAS (versi√≥n 9.4): utilizado para el preprocesamiento de datos, recodificaci√≥n de variables, an√°lisis descriptivo y ejecuci√≥n del modelo ANCOVA.

-   RStudio (versi√≥n 2024.03.0): se emple√≥ de forma complementaria para la verificaci√≥n cruzada de resultados mediante el uso de los paquetes car (Anova Type III), ggplot2 (visualizaci√≥n de efectos marginales) y emmeans (estimaci√≥n de medi as marginales ajustadas).

## Resultados y discusi√≥n

Los resultados finales desde los distintos m√©todos exploratorios realizados para la obtenci√≥n del modelo m√°s simple fueron Modelo ANCOVA a dos v√≠as:

**Componentes aleatorios**

$$ Y_{ijk} \sim Normal(\mu_{ijk}, \sigma^2) $$

$$ \epsilon_{ijk} \sim Normal(\mu_{ijk}, \sigma^2) $$

$$ Var(\epsilon_{ij}) = \sigma^2, \ \forall_{i,j} $$

**Descripci√≥n del modelo**

-   Variables finales:

1.  Variable respuesta: Puntaje en matem√°ticas

2.  Variables Explicativas: estas est√°n en dos categor√≠as Factores (Nivel educativo de la madre nivel socioecon√≥mico del estudiante)

3.  Covariable: Puntaje en lectura cr√≠tica

```{r, fig.pos="h", out.width="70%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Caracter√≠sticas.PNG")
```

EL modelo explica el $53.63\%$ de la variabilidad de los datos, esto sugiere un buen porcentaje y se puede observar en el coeficiente de determinaci√≥n m√∫ltiple $ùëÖ^2(ùëÖ‚àíùëêùë¢ùëéùëëùëüùëédùëú)$, adem√°s, √©l $ùêπ = 909.86$ es significativo. Esto confirma que, en conjunto, las variables independientes utilizadas explican una proporci√≥n significativa de la variabilidad observada. Adicional mente, la ra√≠z del error cuadr√°tico medio (Ra√≠z MSE) fue 8.54, l o que sugiere una dispersi√≥n moderada de los residuos alrededor de las predicciones del modelo.

```{r, fig.pos="h", out.width="50%", fig.cap="Modelo", echo=FALSE}
knitr::include_graphics("Modelo.PNG")
```

El an√°lisis de los coeficientes estimados del modelo general lineal revela efectos significativos de las variables explicativas sobre el puntaje en matem√°tica s, controlando por el nivel socioecon√≥mico individual y el puntaje en lectura cr√≠tica. En relaci√≥n con el nivel educativo de la madre (educ_madre_ord), se observ√≥ que los estudiantes cuyas madres poseen un nivel educativo bajo presentan, en promedio, una disminuci√≥n de 1.65 puntos en el puntaje de matem√°ticas en comparaci√≥n con aquellos cuya madre tiene un nivel educativo alto, diferencia que result√≥ altamente significativa **(p \< 0.0001)**. Asimismo, los estudiantes del nivel intermedio evidencian una disminuci√≥n promedio de 0.71 puntos respecto al nivel alto, tambi√©n estad√≠sticamente significativa **(p = 0.0359)**.

Respecto al nivel socioecon√≥mico individual, √∫nicamente la categor√≠a m√°s baja mostr√≥ una diferencia significativa. Los estudiantes clasificados en el nivel socioecon√≥mico obtuvieron en promedio 1.46 puntos menos que aquellos pertenecientes al nivel alto (categor√≠a de referencia), con un valor p de 0.0223. Las dem√°s categor√≠as socioecon√≥micas no mostraron efectos estad√≠sticamente significativos en comparaci√≥n con el nivel alto. Por su parte, la covariable punt_lectura_critica present√≥ un coeficiente positivo altamente significativo (Œ≤ = 0.8826; Por su parte, la covariable punt_lectura_critica present√≥ un coeficiente positivo altamente significativo (Œ≤ = 0.8826; p \< 0.0001), lo cual indica que, manteniendo constantes los dem√°s factores, un incremento dep \< 0.0001), lo cual indica que, manteniendo constantes los dem√°s factores, un incremento de un punto en el puntaje un punto en el puntaje de lectura cr√≠tica se asocia con un aumento promedio de 0.88 puntos en el puntaje de matem√°ticas. Este hallazgo de lectura cr√≠tica se asocia con un aumento promedio de 0.88 puntos en el puntaje de matem√°ticas. Este hallazgo resalta la influencia directa del rendimiento en lectura cr√≠tica sobre el desempe√±o en matem√°ticas, reforzando su resalta la influencia directa del rendimiento en lectura cr√≠tica sobre el desempe√±o en matem√°ticas, reforzando su inclusi√≥n como covariable relevante en el modelo.

**Estad√≠sticos descriptivos**

```{r, fig.pos="h", out.width="70%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("descriptivas.PNG")
```

Los resultados descriptivos muestran que tanto el nivel educativo de la madre como el nivel socioecon√≥mico individual del estudiante est√°n relacionados positivamente con el desempe√±o en lectura cr√≠tica. En promedio, los estudiantes cuya madre tiene mayor nivel educativo obtienen mejores puntajes, pasando de 51.76 a 57.37 puntos. De forma similar, a mayor nivel socioecon√≥mico, los puntajes tambi√©n aumentan, desde 50.55 en el nivel bajo hasta 61.50 en el nivel alto. Estos resultados sugieren que ambos factores est√°n asociados con un mejor rendimiento en lectura cr√≠tica.

## Verificaci√≥n de supuestos

-   **Independencia**

Se valido mediante la prueba de Durbin Watson, ya que como es una muestra grande, las otras pruebas podr√≠an, afectar la decisi√≥n en el juzgamiento

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Independencia.PNG")
```

Podemos observar que el p valor es mayor que cualquier nivel de significancia, no se rechaza la hip√≥tesis nula de ausencia de autocorrelaci√≥n. Por tanto, no hay evidencia estad√≠sticamente significativa de autocorrelaci√≥n en los residuos del modelo, lo cual indica que se cumple el supuesto de independencia de los errores en la regresi√≥n.

-   **Relaci√≥n lineal**

```{r, fig.pos="h", out.width="60%", fig.cap="Medidas descriptivas", echo=FALSE, warning=FALSE, message=FALSE}
lineal
```

El gr√°fico sugiere que la relaci√≥n entre la covariable (puntaje en lectura cr√≠tica) y la variable puntaje en matem√°ticas es aproximadamente lineal dentro de cada nivel del factor socioecon√≥mico. Por tanto, el supuesto de linealidad para el modelo ANCOVA se considera razonablemente cumplido.

-   **Homogeneidad**

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("homogeneidad.PNG")
```

La prueba de homogeneidad de pendientes no fue significativa por el p valor obtenido , lo que indica que la relaci√≥n entre el covariable puntaje lectura cr√≠tica y la variable dependiente punt aje en matem√°ticas es constante entre los niveles socioecon√≥micos del estudiante. Por tanto, se cumple el supuesto de homogeneidad de pendientes en el modelo ANCOVA.

```{r, fig.pos="h", out.width="55%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Homo_pendientes.PNG")
```

-   **Homocedasticidad** Se valido mediante gr√°fico de residuos vs valores ajustados y la prueba de Breusch Pagan

```{r, fig.pos="h", out.width="45%", fig.cap="homocedasticidad", echo=FALSE, include=FALSE, message=FALSE}
homoceda
```

El gr√°fico de escala localizaci√≥n sugiere que los residuos presentan una varianza aproximadamente constante a lo largo de los valores ajustados , esto podr√≠a afirmar que el supuesto de homocedasticidad se considera cumplido.

```{r, fig.pos="h", out.width="45%", echo=FALSE}
knitr::include_graphics("Homocedasticidad.PNG")
```

Como el p valor es mayor que cualquier nivel de significancia, no se rechaza la hip√≥tesis nula de homocedasticidad. En consecuencia, se puede asumir que se cumple el supuesto de varianza constante de los errores

-   **Normalidad de residuos**

Se examina visualmente a trav√©s del gr√°fico Cuantil-Cuantil (Q-Q plot) y se contrasta estad√≠sticamente mediante la prueba de Kolmog√≥rov Smirnov , dado que la muestra es considerablemente grande , tambi√©n se realizo un histograma p ara dar una breve observaci√≥n

*Histograma*

```{r,  fig.pos="h", out.width="45%", fig.cap="cuantil_cuantil", warning=FALSE, message=FALSE}
Q_Q
```

**Histograma**

```{r,  fig.pos="h", out.width="45%", fig.cap="Histograma", warning=FALSE, message=FALSE}
Hist_residuales
```

Se observa en el gr√°fico Q_Q que los residuos est√°n alineados mayoritariamente a la l√≠nea referencial te√≥rica , esto indagar√≠a que no hay desviaciones significativas respecto a la normalidad de los residuos. Si bien se aprecia una leve discrepancia en los extremos del gr√°fico, este comportamiento es com√∫n en datos reales y no constituye una irregularidad que comprometa la validez del modelo

```{r, fig.pos="h", out.width="45%", fig.cap="Medidas descriptivas", echo=FALSE}
knitr::include_graphics("Normalidad.PNG")
```

Con esta prueba, aunque no tan confiable por el n√∫mero de datos , se observa que el p valor no es significativo, luego no se rechaza la hip√≥tesis nula, entonces, los residuos siguen una distribuci√≥n Normal.

## Detenci√≥n de datos influyentes

```{r, fig.pos="h", out.width="150%", echo=FALSE}
knitr::include_graphics("DFFIT.PNG")
```

Los gr√°ficos de diagn√≥stico revelan que, en general, el modelo de regresi√≥n no presenta problemas graves de influencia o valores at√≠picos. El gr√°fico de DFFITS muestra que la mayor√≠a de las observaciones no tienen un impacto significativo en las predicci√≥n es. Sin embargo, en el gr√°fico de Cook‚Äôs Distance se identifica una observaci√≥n alrededor del √≠ndice 3000 con una influencia destacada. Los gr√°ficos de leverage y residuos estandarizados confirman que, aunque la mayor√≠a de los puntos son normales, existen algunas observaciones espec√≠ficas (como las cercanas a los √≠ndices 2900 y 4472) que combinan alto leverage y residuos grandes, indicando que podr√≠an estar afectando el ajuste del modelo. Se recomienda revisar a futuro estas observaciones influyentes para a segurar la robustez del modelo.

## Eliminaci√≥n

Para asegurar la validez del modelo ANCOVA y mejorar la precisi√≥n de las estimaciones, se realiz√≥ una depuraci√≥n del conjunto de datos mediante la identificaci√≥n y eliminaci√≥n de observaciones at√≠picas multivariantes.

La detecci√≥n se bas√≥ en el c√°lculo de la distancia de Mahalanobis aplicada a las variables num√©ricas involucradas en el modelo: punt_matematicas y punt_lectura_critica. Se estableci√≥ como umbral de corte el percentil 99 de la distribuci√≥n Chi-cuadrado con 2 grados de libertad, eliminando aquellas observaciones que superaban dicho l√≠mite.

Como resultado, se obtuvo un conjunto de datos m√°s robusto, libre de valores extremos que pudieran influir de forma indebida en la interpretaci√≥n de los efectos de los factores educ_madre_ord y estu_nse_individual sobre el rendimiento en matem√°ticas, controlando por el puntaje en lectura cr√≠tica.

```{r, fig.pos="h", out.width="60%", echo=FALSE}
knitr::include_graphics("modelo_fin.PNG")
```

El presente estudio implement√≥ un modelo de ANCOVA de dos v√≠as para analizar los determinantes del rendimiento en matem√°ticas en estudiantes, considerando como variables predictoras: (1) el nivel educativo de la madre (variable ordinal con tres categor√≠as), (2) el nivel socioecon√≥mico del estudiante (variable ordinal con cuatro categor√≠as), y (3) el puntaje en lectura cr√≠tica como covariable continua. Antes del ajuste del modelo, se eliminaron observaciones at√≠picas multivariantes mediante el c√°lculo de la distancia de Mahalanobis sobre las variables num√©ricas implicadas, con el fin de mejorar la robustez del an√°lisis y reducir la influencia de valores extremos.

El modelo final, libre de datos at√≠picos, fue validado mediante el cumplimiento de los supuestos estad√≠sticos (normalidad de residuos, homocedasticidad y linealidad), mostrando un buen ajuste para el an√°lisis inferencial.

Los resultados revelaron patrones consistentes con la literatura educativa. La covariable lectura cr√≠tica mostr√≥ el efecto m√°s fuerte y estad√≠sticamente significativo, con un coeficiente de 0.877 (ùëù \< 0.0001), indicando que, por cada punto adicional en dicha prueba, se espera un aumento promedio de 0.877 puntos en el rendimiento matem√°tico, manteniendo constantes los dem√°s factores. Este resultado reafirma la conexi√≥n entre habilidades ling√º√≠sticas y desempe√±o en matem√°ticas.

Respecto al nivel educativo de la madre, los estudiantes cuyas madres ten√≠an educaci√≥n b√°sica incompleta (nivel 1) obtuvieron, en promedio, 1.21 puntos menos que aquellos con madres de educaci√≥n superior (nivel de referencia), siendo esta diferencia estad√≠sticamente significativa (ùëù = 0.0005). La diferencia para educaci√≥n b√°sica completa (nivel 2) fue menor y no significativa (-0.44 puntos; ùëù = 0.1609). Este patr√≥n sugiere que el capital educativo del hogar sigue siendo un determinante relevante del rendimiento, especialmente cuando se trata de niveles muy bajos de escolarizaci√≥n.

En cuanto al nivel socioecon√≥mico individual, el grupo estrato bajo (nivel 1) present√≥ una diferencia negativa significativa de 1.48 puntos respecto al estrato alto (ùëù = 0.0123), mientras que los niveles 2 y 3 no mostraron diferencias estad√≠sticamente significativas. Esto sugiere que el mayor impacto negativo se concentra en los estudiantes en condiciones de vulnerabilidad extrema, mientras que las diferencias entre niveles medios y altos tienden a diluirse.

## Conclusiones

La competencia en lectura cr√≠tica contin√∫a siendo el predictor m√°s fuerte del rendimiento en matem√°ticas, lo que respalda enfoques pedag√≥gicos integrados que fortalezcan simult√°neamente las habilidades verbales y l√≥gico-matem√°ticas.

-   El efecto del nivel educativo de la madre, aunque atenuado tras eliminar los valores extremos, se mantiene como un factor de peso, especialmente en los niveles m√°s bajos. Esto refuerza la necesidad de pol√≠ticas educativas intergeneracionales que favorezcan el acceso a la educaci√≥n para madres con baja escolaridad.

-   La desventaja significativa observada en el estrato socioecon√≥mico bajo pone en evidencia la persistencia de las inequidades estructurales. Este hallazgo justifica la implementaci√≥n de estrategias de acompa√±amiento educativo y recursos dirigidos a los estudiantes en mayor riesgo de exclusi√≥n.

El modelo ajustado sin at√≠picos ofrece una visi√≥n m√°s precisa del fen√≥meno y mejora la confiabilidad de las inferencias. Se sugiere ampliar el modelo en futuros estudios incorporando variables contextuales adicionales (como calidad docente, infraestructura escolar o apoyo familiar), as√≠ como aplicar modelos longitudinales que permitan evaluar c√≥mo evolucionan estos efectos a lo largo del tiempo educativo.

## REFERENCIAS

-   <https://www.icfes.gov.co/wp> content/uploads/2024/11/Edicion 4 boletin saber al detalle -

-   -.pdf <https://bookdown.org/j_morales/librostat/ancova.html> Instituto Colombiano para la Evaluaci√≥n de la Educaci√≥n Icfes. (marzo de 2024). DataIcfes: Repositorio de Datos Abiertos del Icfes. 04.Saber11 [Conjunto de datos]. Recuperado de <https://bitly.ws/3f3YC>

-   <https://statistics.laerd.com/spss> tutorials/two way ancova using spss statistics .php
sadsadasdasdasdas
-   <https://bookdown.org/j_morales/weblinmod/04ML> ANOVA ANCOVA.html
